import requests
from bs4 import BeautifulSoup

def fetch_race_links(year):
    url = f"https://www.formula1.com/en/results.html/{year}/races.html"
    response = requests.get(url)
    print(response)

    if response.status_code != 200:
        return f"Failed to fetch data for year {year}: {response.status_code}"

    soup = BeautifulSoup(response.text, "html.parser")

    items = soup.find_all(
        lambda tag: tag.name == "a"
        and "resultsarchive-filter-item-link" in tag.get("class", [])
        and tag.get("data-name") == "meetingKey"
    )

    race_data = []
    for element in items:
        data_value = element.get("data-value")
        if data_value:
            href = "https://www.formula1.com" + element.get("href")
            race_data.append({"year": year, "data_value": data_value, "href": href})

    return race_data


print(fetch_race_links(2023))